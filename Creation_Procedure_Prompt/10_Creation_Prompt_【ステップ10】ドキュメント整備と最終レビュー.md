かしこまりました。「【ステップ10】ドキュメント整備と最終レビュー」のための、AI（Jules）への詳細なプロンプトを作成します。

このステップは、開発の最終段階であり、作成されたマクロの品質を保証し、将来の保守や利用を円滑にするための重要な工程です。AIには、コードの最終チェックと、ユーザーおよび開発者向けドキュメントの完成を依頼します。

---

## プロンプト (AI: Jules向け) - ステップ10: ドキュメント整備と最終レビュー

**依頼プロジェクト名:** VBA Schedule Aggregator (工程表データ集約マクロ) - 再構築 (ステップ10)

**現在の開発ステップ:** 【ステップ10】ドキュメント整備と最終レビュー

**このステップの目的:**
これまでのステップで開発された「VBA Schedule Aggregator」マクロのコード全体の最終レビューを行い、品質を確保するとともに、ユーザーおよび将来のメンテナーが必要とする全ての関連ドキュメント（README、仕様書、Configシート定義、期待する動作、命名規則、開発ノートなど）を完成させ、プロジェクトを完了状態にすることです。AIには、コードの最終的なリファクタリング提案（もしあれば）、コメントの網羅性の確認、そして各ドキュメント内容の最新化と整合性の確保を依頼します。

**参照必須ドキュメント (これまでの全ドキュメントと生成されたVBAコード):**
1.  `docs/00_Project_Overview.md`
2.  `docs/01_System_Instructions_for_AI.md`
3.  `docs/02_Prompt_for_AI.md` (これまでの各ステップのプロンプトを含む)
4.  `docs/03_Functional_Specification.md`
5.  `docs/04_Config_Sheet_Definition.md`
6.  `docs/05_Expected_Behavior.md`
7.  `docs/06_Development_Notes_and_Considerations.md`
8.  `docs/07_Naming_Conventions_and_Glossary.md`
9.  生成された全てのVBAモジュールコード (`M00`～`M06`, およびあれば `M_Utilities`)

**前提条件:**
*   「【ステップ1】～【ステップ9】」が完了し、マクロの全機能が実装され、基本的な動作テストが完了していること。
*   主要なドキュメントの草案が既に存在していること。

**あなたのタスク:**
以下の項目について、最終的な確認、修正、およびドキュメントの完成作業を行ってください。

**1. VBAコードの最終レビューとリファクタリング提案:**

*   **コード全体の可読性:**
    *   全てのモジュール、プロシージャ、変数、定数名が、「07_Naming_Conventions_and_Glossary.md」および「01_System_Instructions_for_AI.md」の命名規則に準拠し、一貫性があり、かつその役割が明確に理解できるか最終確認してください。
    *   インデント、空行の使い方が適切で、コードの構造が視覚的に理解しやすいか確認してください。
*   **コメントの網羅性と品質:**
    *   全てのモジュールヘッダ、プロシージャヘッダ、変数宣言、主要なロジックブロック、ループ、条件分岐に、**VBA初心者が読んでも処理の意図と流れが理解できるレベルの、詳細かつ平易な日本語コメント**が記述されているか徹底的に確認してください。不足している箇所があれば追記してください。
*   **エラーハンドリングの網羅性:**
    *   全てのプロシージャでエラーハンドリングが適切に実装されているか、特に`On Error Resume Next`の使用が限定的かつ直後にエラーチェックが行われているか確認してください。
    *   エラーログに出力される情報が、問題解決に十分な詳細度を持っているか確認してください。
*   **ロジックの効率性と堅牢性:**
    *   冗長なコードや非効率なループ処理がないか確認してください。
    *   配列のインデックス管理、オブジェクト変数の解放（`Set ... = Nothing`）が適切に行われているか確認してください。
    *   潜在的なバグや、特定の条件下でエラーを引き起こしそうな箇所がないか、批判的な視点で見直してください。
*   **`Config`シート設定値の利用:**
    *   VBAコード内で参照されている全てのConfigシート設定値（セルアドレス、項目名）が、「04_Config_Sheet_Definition.md」と完全に一致しているか確認してください。
    *   `O122`フラグによる分岐ロジックが、仕様通りに正確に実装されているか再検証してください。
*   **リファクタリング提案 (もしあれば):**
    *   上記の観点から、コードの構造、ロジック、命名などで、より改善できる点があれば具体的な修正案を提示してください。ただし、大幅なロジック変更はこのステップでは避け、主に可読性や堅牢性の向上に繋がる微調整を優先してください。

**2. ドキュメントの最終化:**

*   **`README.md` の完成:**
    *   前回の提案内容をベースに、マクロの最終的な機能、セットアップ手順、使用方法、フォルダ構成、開発者向け情報、貢献方法、ライセンス情報（もしあれば）を網羅し、プロジェクトの顔として十分な品質に仕上げてください。
    *   フォルダ・ファイル構成の記述が、最終的なリポジトリ構成と一致していることを確認してください。
*   **`docs/00_Project_Overview.md` の最終確認:**
    *   プロジェクトの目的、範囲などが現状と一致しているか確認し、必要なら微調整してください。
*   **`docs/03_Functional_Specification.md` の最終確認:**
    *   実装された機能と仕様書の記述に齟齬がないか確認してください。
*   **`docs/04_Config_Sheet_Definition.md` の最終確認と完全性:**
    *   **これが最も重要なドキュメントの一つです。** Configシートの全てのセル範囲、項目名、設定可能な値、その詳細な意味、マクロの動作への影響、関連する他の設定項目などが、**実際のVBAコードの動作と完全に一致するように、かつユーザーが設定に迷わないように、極めて詳細かつ正確に記述されているか**徹底的にレビューし、必要な修正・追記を行ってください。CSVファイルから転記した情報も反映させてください。
*   **`docs/05_Expected_Behavior.md` の最終確認:**
    *   マクロの実際の動作フローとドキュメントの記述に齟齬がないか確認してください。特にエラー発生時の挙動やユーザーへの通知内容が正確か。
*   **`docs/06_Development_Notes_and_Considerations.md` の完成:**
    *   これまでの開発過程で明らかになった重要な注意点、AIへの指示のポイント、過去に発生した特有の問題とその解決策、将来的な拡張のヒントなどを、後任の開発者やAIが参照できるように整理・追記してください。
*   **`docs/07_Naming_Conventions_and_Glossary.md` の完成:**
    *   実際にコードで使用された主要なグローバル変数、ユーザー定義型、主要なPublicプロシージャ名をリストアップし、その命名規則と役割を説明するセクションを追記・完成させてください。AIが生成した命名が一貫しているか、このドキュメントの規則に準じているかも確認してください。
*   **全ドキュメントの整合性:**
    *   各ドキュメント間で、用語の不一致、機能説明の矛盾などがないか確認してください。

**3. デバッグモードフラグの最終動作確認:**

*   「Config」シート `O3` のデバッグモードフラグを `TRUE` および `FALSE` に設定した場合で、イミディエイトウィンドウへのログ出力が正しく制御されるか最終確認してください。
*   `DEBUG_MODE_ERROR`, `DEBUG_MODE_WARNING`, `DEBUG_MODE_DETAIL` の各定数が、それぞれの目的に応じたログレベルを適切に制御しているか確認してください。

**生成コード・ドキュメントに関する期待:**
*   全てのVBAモジュールコードは、最終レビューと必要な微調整が完了し、コメントも完璧な状態であること。
*   `docs`フォルダ内の全てのMarkdownドキュメントが、最終的なマクロの仕様と動作を正確に反映し、ユーザーおよび開発者にとって明確で役立つ情報を提供していること。
*   特に`04_Config_Sheet_Definition.md`は、ユーザーがConfigシートを設定する際の唯一かつ完全なリファレンスとなる品質であること。
*   全体として、プロジェクトが「完了」と呼べる状態になっていること。

**成果物:**
*   最終レビュー・修正が完了した、全てのVBAモジュールの完全なソースコード。
*   完成された、`docs`フォルダ内の全てのドキュメントファイル（Markdown形式）。

---

この最終ステップでは、AIの能力を「コード生成」だけでなく、「コードレビュー」「ドキュメント作成・校正」といった面でも活用することを期待しています。
これにより、プロジェクト全体の品質を最大限に高めることができるはずです。