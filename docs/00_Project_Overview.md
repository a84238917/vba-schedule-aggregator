# プロジェクト概要: VBA Schedule Aggregator (工程表データ集約マクロ)

## 1. プロジェクトの目的と背景

このプロジェクトの主な目的は、**社内で使用されている複数のExcel形式の月間工程表から、必要な情報を効率的かつ正確に抽出し、一元的なデータベース形式に集約するVBAマクロを開発すること**です。

従来、これらの工程表からのデータ収集や集計は手作業で行われており、以下の課題が存在していました。

*   **作業負荷の増大:** 工程表の数やデータ量が増えるにつれて、手作業によるデータ入力・転記作業の負担が非常に大きくなっている。
*   **人的ミスの発生:** 手作業によるデータ処理は、入力ミスや転記漏れなどのヒューマンエラーが発生しやすく、データの信頼性に影響を与える可能性がある。
*   **非効率性:** 定期的なデータ集計作業に多くの時間を費やしており、より付加価値の高い業務へのリソース配分が困難になっている。
*   **フォーマットの多様性:** 工程表のフォーマットがファイルごと、あるいは時期によって微妙に異なる場合があり、手作業での対応が煩雑になっている。

本マクロは、これらの課題を解決し、データ集約プロセスの自動化を通じて業務効率の大幅な向上とデータ品質の確保を目指します。

## 2. マクロが解決する主要な課題

*   **データ集約の自動化:** 複数の工程表ファイルから必要なデータを自動的に読み込み、指定されたExcelシートに集約します。
*   **抽出ルールの柔軟性:** データ抽出の対象となる項目、その位置、処理対象のシート名、適用するフィルター条件などを、VBAコードを直接編集することなく「Config」シートで容易に変更可能にします。
*   **多様な工程表フォーマットへの対応:** 「工程パターン」という概念を導入し、ファイルごとに異なる可能性のあるデータ構造（特に1日あたりの作業ブロックの列数など）に柔軟に対応します。
*   **データ品質の向上:** 自動処理による入力ミスや転記漏れの削減を目指します。
*   **作業時間の削減:** データ集約にかかる時間を大幅に短縮し、担当者がより戦略的な業務に集中できる環境を提供します。

## 3. ターゲットユーザー

*   主に、月間の工程表データを定期的に収集・集計し、分析や報告に使用する必要のある部門の担当者。
*   VBAの専門知識がないユーザーでも、Configシートを通じてマクロの設定変更がある程度行えることを想定しています。

## 4. プロジェクトの範囲

*   **範囲内:**
    *   「Config」シートに基づいたデータ抽出・集約処理。
    *   指定されたExcelファイル形式（.xlsx, .xls, .xlsm）からのデータ読み取り。
    *   複数のフィルター条件によるデータ絞り込み。
    *   エラーログ、処理ログの生成。
    *   基本的なデバッグ機能の提供。
*   **範囲外 (現時点):**
    *   工程表ファイルの自動生成や編集。
    *   抽出データの高度な統計分析やグラフ化（これらは出力された「一覧」シートを元に別途行う想定）。
    *   Webアプリケーションや外部データベースとの直接連携。
    *   マクロによる「Config」シートの自動更新（一部、工程パターン適用時の`O126`セルへの転記を除く）。

## 5. 期待される成果

*   手作業によるデータ集約作業と比較して、大幅な時間短縮と工数削減。
*   データの一貫性と正確性の向上。
*   将来的な工程表フォーマットの変更や抽出ニーズの変化に対して、比較的容易に対応できる保守性の高いマクロ。

## 6. ドキュメント構成

このプロジェクトの関連ドキュメントは、`docs`フォルダ内に以下の構成で格納されています。

*   `00_Project_Overview.md` (このファイル)
*   `01_System_Instructions_for_AI.md`: AIへの開発原則指示。
*   `02_Prompt_for_AI.md`: AIへの具体的な生成指示。
*   `03_Functional_Specification.md`: マクロの機能仕様。
*   `04_Config_Sheet_Definition.md`: Configシートの詳細定義。
*   `05_Expected_Behavior.md`: マクロの期待動作フロー。
*   `06_Development_Notes_and_Considerations.md`: 開発上の補足事項。
