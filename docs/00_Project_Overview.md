## このドキュメントの目的 (存在意義)

この「プロジェクト概要」ドキュメントは、**「VBA Schedule Aggregator (工程表データ集約マクロ)」プロジェクトの全体像を迅速に理解するための入り口**として機能します。
プロジェクトの背景にある課題、マクロ開発によって達成したい目標、マクロが提供する主要な価値、ターゲットとする利用者、そしてプロジェクトの技術的な範囲と限界を明確に定義しています。
この文書を読むことで、開発者、関係者、そして将来このプロジェクトに新たに関わる全ての人が、**「なぜこのマクロが必要なのか」「何をするためのものなのか」「何が期待できるのか」**といった根本的な問いに対する共通認識を持つことができます。
これは、プロジェクト全体の方向性を定め、関係者間のコミュニケーションを円滑にし、最終的な成果物がユーザーの真のニーズに応えるための基盤となります。


# プロジェクト概要: VBA Schedule Aggregator (工程表データ集約マクロ)

## 1. プロジェクトの目的と背景

このプロジェクトの核心的な目的は、**社内で日々作成・更新される複数のExcel形式月間工程表に散在する業務データを、効率的かつ正確に一つのデータベース形式へ集約するための、高度に自動化されたVBAマクロを開発すること**です。

現状、これらの工程表からのデータ収集と集計は主に手作業に依存しており、以下のような顕著な課題が生じています。

*   **増大する作業負荷:** 工程表の数や各表内のデータ項目が増加するにつれ、手作業によるデータ転記や入力の負担が限界に近づいています。
*   **人的ミスの潜在リスク:** 手作業には、入力ミス、転記漏れ、計算誤りといったヒューマンエラーが常に伴い、集約データの信頼性や精度を低下させる可能性があります。
*   **リソースの非効率な配分:** 定期的なデータ集約作業に多くの貴重な時間が費やされ、担当者がより戦略的で付加価値の高い業務に取り組む機会が奪われています。
*   **フォーマットの不統一への対応困難:** 工程表のレイアウトや記載項目が、ファイルごと、あるいは作成時期や担当者によって微妙に異なる場合があり、手作業での柔軟な対応が煩雑化・複雑化しています。

本VBAマクロは、これらの課題を根本から解決し、データ集約プロセスの完全自動化を通じて、**業務効率の飛躍的な向上、データ品質の恒常的な確保、そして担当者の作業負担の大幅な軽減**を実現することを目指します。

## 2. マクロが解決する主要な課題と提供価値

*   **データ集約プロセスの自動化:** 複数の工程表ファイルから必要な情報を自動的に読み取り、マクロ実行ファイル内の指定されたワークシートに一元的に集約します。
*   **抽出ルールの高度な柔軟性とユーザーによる設定変更:** データ抽出の対象となる項目、それらが工程表内のどこに位置するか、処理対象とするシート名、適用するデータ絞り込み条件など、マクロの動作を規定するほぼ全ての要素を、VBAコードを直接編集することなく、専用の「Config」シートを通じてユーザーが容易に変更・管理できる仕組みを提供します。
*   **多様な工程表フォーマットへの適応力:** 「工程パターン」という概念を導入し、ファイルごとに異なる可能性のあるデータ構造（特に1日の作業工程ブロックの列構成や、それに伴う作業員情報の配置など）に対して、マクロが動的かつ柔軟に対応できるようにします。
*   **データ整合性と品質の向上:** 自動化されたプロセスにより、手作業に起因する入力ミスや転記漏れを根本的に排除し、集約データの正確性と一貫性を高めます。
*   **業務時間の劇的な削減:** データ集約にかかる時間を大幅に短縮することで、担当者は煩雑な手作業から解放され、より分析的・戦略的な業務に注力できるようになります。
*   **トレーサビリティと問題解決の支援:** 処理の実行条件や結果、発生したエラーに関する詳細なログ情報を専用シートに出力することで、マクロの動作状況の追跡や、問題発生時の原因究明を容易にします。

## 3. ターゲットユーザーと利用シーン

*   **主な利用者:** 日々の業務で発生する月間工程表のデータを定期的に収集・集計し、それらを分析資料の作成、進捗管理、リソース配分計画、報告業務などに活用する必要がある各部門の担当者を想定しています。
*   **期待されるスキルレベル:** VBAに関する専門的な知識を持たないユーザーでも、「Config」シートの各設定項目の意味を理解し、自身の業務要件に合わせて設定値を変更することで、マクロの抽出動作をカスタマイズできることを目指します。

## 4. プロジェクトの技術的範囲と限界

*   **本マクロの機能範囲 (In Scope):**
    *   「Config」シートの設定情報に基づいた、定義済みデータ項目の抽出と集約処理。
    *   指定されたExcelファイル形式（`.xlsx`, `.xls`, `.xlsm`）からのデータ読み取り。
    *   ユーザー定義による複数のフィルター条件を組み合わせた、柔軟なデータ絞り込み機能。
    *   エラーログ、処理（検索条件）ログの自動生成と記録。
    *   基本的なデバッグ支援機能（イミディエイトウィンドウへの詳細ログ出力、ConfigでON/OFF可能）。
    *   処理対象ファイルのパス指定（直接指定、フォルダ指定、ファイルダイアログ選択）。
    *   工程表ファイルの読み取り専用でのオープン。
*   **本マクロの機能範囲外 (Out of Scope - 現時点):**
    *   工程表ファイル自体の新規作成、編集、または書式設定の変更。
    *   抽出・集約されたデータに対する高度な統計分析、データ可視化（グラフ作成など）。これらは出力された「一覧」シートを元に、Excelの標準機能や他のツールを用いて別途行うことを想定します。
    *   Webアプリケーション、外部データベースシステム、その他の業務システムとのリアルタイムな直接連携。
    *   マクロ自身による「Config」シートの設定値の自動更新や動的変更（ただし、工程パターン適用における特定セルへの一時的な値転記といった、処理上必須な限定的ケースは除く）。

## 5. 期待されるビジネス上の成果と価値

*   **業務効率の大幅改善:** 手作業によるデータ集約と比較して、処理時間を劇的に短縮し、関連する作業工数を大幅に削減します。
*   **データドリブンな意思決定の促進:** 迅速かつ正確に集約されたデータに基づき、より質の高い分析とタイムリーな意思決定を支援します。
*   **人的資源の最適配分:** ルーチンワークから解放された担当者が、より創造的で付加価値の高い業務に集中できるようになります。
*   **運用持続性の向上:** 将来的な工程表フォーマットの変更や、新たな抽出ニーズの発生に対しても、「Config」シートの設定変更により、比較的容易かつ迅速に対応可能な、保守性の高いソリューションを提供します。

## 6. 本プロジェクトの関連ドキュメント構成

このプロジェクトに関連する全てのドキュメントは、Gitリポジトリ内の `docs` フォルダに、以下の標準化されたファイル名と連番で格納・管理されています。マクロ開発や保守に関わる全ての担当者は、これらのドキュメントを参照し、理解を深めることが推奨されます。

*   `docs/00_Project_Overview.md` (現在閲覧中のこのファイル)
*   `docs/01_System_Instructions_for_AI.md`: AI（開発者）に対する、マクロ開発時の基本原則や品質要件に関する指示書。
*   `docs/02_Prompt_for_AI.md`: AIに具体的なマクロコードの生成を依頼する際の、包括的なプロンプト。
*   `docs/03_Functional_Specification.md`: マクロが提供すべき機能や満たすべき要件を定義した機能仕様書。
*   `docs/04_Config_Sheet_Definition.md`: 「Config」シートの各設定項目、セル位置、設定可能な値、それがマクロの動作にどう影響するかを詳細に定義したリファレンス。
*   `docs/05_Expected_Behavior.md`: マクロが実行された際に、ユーザーから見てどのような順序で何が起こるか、エラー発生時にどう振る舞うかなど、具体的な動作フローを記述した文書。
*   `docs/06_Development_Notes_and_Considerations.md`: 開発を進める上での技術的な注意点、過去の課題からの教訓、AIへの補足的な指示や考慮事項などをまとめた文書。
*   `docs/07_Naming_Conventions_and_Glossary.md`: プロジェクト内で使用する変数名、関数名などの命名規則や、主要な専門用語の定義集。